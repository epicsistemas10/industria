import{b as J,c as K,u as U,r as a,s as n,j as e}from"./index-FRp6wVcD.js";import{S as C,T as S}from"./TopBar-DS7MBlT5.js";function Y(){var _,q;const{id:k}=J(),[D]=K(),i=k||D.get("id"),h=U(),[l,p]=a.useState(!0),[d,u]=a.useState(!0),[o,R]=a.useState("geral"),[t,A]=a.useState(null),[g,E]=a.useState([]),[j,T]=a.useState([]),[b,$]=a.useState([]),[B,f]=a.useState(!0),[M,m]=a.useState(!1),[O,L]=a.useState([]),[N,v]=a.useState(""),[y,w]=a.useState(1);a.useEffect(()=>{i&&(P(),x(),F(),I())},[i]);const P=async()=>{f(!0);const{data:s}=await n.from("equipamentos").select("*, setores(nome)").eq("id",i).single();s&&A(s),f(!1)},x=async()=>{const{data:s}=await n.from("equipamentos_componentes").select("quantidade_usada, componentes(id, nome, codigo_interno, marca, tipos_componentes(nome))").eq("equipamento_id",i);if(s){const r=s.map(c=>({id:c.componentes.id,nome:c.componentes.nome,codigo_interno:c.componentes.codigo_interno,marca:c.componentes.marca,tipos_componentes:c.componentes.tipos_componentes,quantidade_usada:c.quantidade_usada}));E(r)}},F=async()=>{const{data:s}=await n.from("ordens_servico").select("*").eq("equipamento_id",i).order("data_abertura",{ascending:!1}).limit(10);s&&T(s)},I=async()=>{const{data:s}=await n.from("historico_revisoes").select("*").eq("equipamento_id",i).order("data_revisao",{ascending:!1});s&&$(s)},H=async()=>{const{data:s}=await n.from("componentes").select("id, nome, codigo_interno, marca, tipos_componentes(nome)").order("nome");s&&L(s)},Q=async s=>{s.preventDefault(),await n.from("equipamentos_componentes").insert([{equipamento_id:i,componente_id:N,quantidade_usada:y}]),m(!1),v(""),w(1),x()},z=async s=>{confirm("Tem certeza que deseja remover este componente?")&&(await n.from("equipamentos_componentes").delete().eq("equipamento_id",i).eq("componente_id",s),x())},V=s=>{switch(s){case"Baixa":return"bg-green-500/20 text-green-400 border-green-500/30";case"Média":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"Alta":return"bg-orange-500/20 text-orange-400 border-orange-500/30";case"Crítica":return"bg-red-500/20 text-red-400 border-red-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},G=s=>{switch(s){case"Aberta":return"bg-blue-500/20 text-blue-400 border-blue-500/30";case"Em Andamento":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"Concluída":return"bg-green-500/20 text-green-400 border-green-500/30";case"Cancelada":return"bg-red-500/20 text-red-400 border-red-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}};return B?e.jsx("div",{className:"min-h-screen bg-gray-950 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):t?e.jsxs("div",{className:"min-h-screen bg-gray-950 flex",children:[e.jsx(C,{isOpen:l,onToggle:()=>p(!l),darkMode:d}),e.jsxs("div",{className:`flex-1 flex flex-col transition-all duration-300 ${l?"ml-64":"ml-20"}`,children:[e.jsx(S,{darkMode:d,setDarkMode:u}),e.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("button",{onClick:()=>h("/equipamentos"),className:"text-white/80 hover:text-white mb-4 flex items-center gap-2 transition-colors cursor-pointer",children:[e.jsx("i",{className:"ri-arrow-left-line"}),"Voltar para Equipamentos"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:t.nome}),e.jsxs("div",{className:"flex items-center gap-4 text-blue-100",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"ri-building-line"}),(_=t.setores)==null?void 0:_.nome]}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"ri-factory-line"}),t.fabricante]}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("i",{className:"ri-settings-3-line"}),t.modelo]})]})]}),e.jsx("div",{className:`px-4 py-2 rounded-full text-sm font-semibold border ${V(t.criticidade)}`,children:t.criticidade})]})]})}),e.jsx("div",{className:"max-w-7xl mx-auto p-6",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg border border-gray-800 mb-6",children:[e.jsx("div",{className:"flex border-b border-gray-800 overflow-x-auto",children:[{id:"geral",label:"Geral",icon:"ri-information-line"},{id:"componentes",label:"Componentes",icon:"ri-settings-4-line"},{id:"os",label:"Ordens de Serviço",icon:"ri-file-list-3-line"},{id:"custos",label:"Custos",icon:"ri-money-dollar-circle-line"},{id:"historico",label:"Histórico",icon:"ri-history-line"}].map(s=>e.jsxs("button",{onClick:()=>R(s.id),className:`flex items-center gap-2 px-6 py-4 font-medium transition-colors whitespace-nowrap ${o===s.id?"text-blue-400 border-b-2 border-blue-400":"text-gray-400 hover:text-gray-300"}`,children:[e.jsx("i",{className:s.icon}),s.label]},s.id))}),e.jsxs("div",{className:"p-6",children:[o==="geral"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Imagem do Equipamento"}),e.jsx("div",{className:"relative h-64 bg-gradient-to-br from-gray-700 to-gray-800 rounded-lg overflow-hidden",children:t.foto_url?e.jsx("img",{src:t.foto_url,alt:t.nome,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("i",{className:"ri-tools-line text-8xl text-gray-600"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Informações Técnicas"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Fabricante:"}),e.jsx("span",{className:"text-white font-medium",children:t.fabricante})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Modelo:"}),e.jsx("span",{className:"text-white font-medium",children:t.modelo})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Ano de Fabricação:"}),e.jsx("span",{className:"text-white font-medium",children:t.ano_fabricacao})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Setor:"}),e.jsx("span",{className:"text-white font-medium",children:(q=t.setores)==null?void 0:q.nome})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"MTBF:"}),e.jsxs("span",{className:"text-white font-medium",children:[t.mtbf||"N/A"," horas"]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Status da Revisão"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Progresso:"}),e.jsxs("span",{className:"text-2xl font-bold text-blue-400",children:[t.status_revisao,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-4 overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-purple-500 transition-all duration-300",style:{width:`${t.status_revisao}%`}})}),t.data_inicio_revisao&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Início:"}),e.jsx("span",{className:"text-white",children:new Date(t.data_inicio_revisao).toLocaleDateString("pt-BR")})]}),t.data_prevista_fim&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-400",children:"Previsão de Término:"}),e.jsx("span",{className:"text-white",children:new Date(t.data_prevista_fim).toLocaleDateString("pt-BR")})]})]})]})]})]}),t.descricao&&e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Descrição"}),e.jsx("p",{className:"text-gray-300 leading-relaxed",children:t.descricao})]})]}),o==="componentes"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-white",children:"Componentes do Equipamento"}),e.jsxs("button",{onClick:()=>{H(),m(!0)},className:"px-4 py-2 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all flex items-center gap-2 whitespace-nowrap",children:[e.jsx("i",{className:"ri-add-line"}),"Adicionar Componente"]})]}),g.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-settings-4-line text-6xl text-gray-700 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Nenhum componente cadastrado"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map(s=>{var r;return e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700 hover:border-purple-500/50 transition-all",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-white font-semibold mb-1",children:s.nome}),e.jsx("p",{className:"text-sm text-gray-400",children:(r=s.tipos_componentes)==null?void 0:r.nome})]}),e.jsx("button",{onClick:()=>z(s.id),className:"text-red-400 hover:text-red-300 transition-colors",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx("i",{className:"ri-barcode-line"}),e.jsx("span",{children:s.codigo_interno||"Sem código"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx("i",{className:"ri-building-4-line"}),e.jsx("span",{children:s.marca||"Sem marca"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-purple-400 font-semibold",children:[e.jsx("i",{className:"ri-stack-line"}),e.jsxs("span",{children:["Quantidade: ",s.quantidade_usada]})]})]})]},s.id)})})]}),o==="os"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Ordens de Serviço"}),j.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-file-list-3-line text-6xl text-gray-700 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Nenhuma ordem de serviço encontrada"})]}):e.jsx("div",{className:"space-y-4",children:j.map(s=>e.jsx("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700 hover:border-blue-500/50 transition-all",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-white font-semibold mb-2",children:s.titulo}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"ri-calendar-line"}),new Date(s.data_abertura).toLocaleDateString("pt-BR")]}),s.data_conclusao&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("i",{className:"ri-check-line"}),"Concluída em ",new Date(s.data_conclusao).toLocaleDateString("pt-BR")]})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold border ${G(s.status)}`,children:s.status})})]})},s.id))})]}),o==="custos"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Análise de Custos"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-money-dollar-circle-line text-2xl text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm",children:"Custo Total"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:"R$ 0,00"})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-purple-600 to-purple-700 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-tools-line text-2xl text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm",children:"Manutenções"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:"R$ 0,00"})]})]})}),e.jsx("div",{className:"bg-gradient-to-br from-pink-600 to-pink-700 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-settings-4-line text-2xl text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-pink-100 text-sm",children:"Componentes"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:"R$ 0,00"})]})]})})]}),e.jsxs("div",{className:"text-center py-12 bg-gray-800 rounded-lg",children:[e.jsx("i",{className:"ri-bar-chart-line text-6xl text-gray-700 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Dados de custos em desenvolvimento"})]})]}),o==="historico"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white mb-6",children:"Histórico de Revisões"}),b.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("i",{className:"ri-history-line text-6xl text-gray-700 mb-4"}),e.jsx("p",{className:"text-gray-400",children:"Nenhum histórico encontrado"})]}):e.jsx("div",{className:"space-y-4",children:b.map(s=>{var r;return e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-semibold",children:s.tipo_revisao}),e.jsx("p",{className:"text-sm text-gray-400",children:new Date(s.data_revisao).toLocaleDateString("pt-BR")})]}),e.jsxs("span",{className:"text-green-400 font-semibold",children:["R$ ",(r=s.custo_total)==null?void 0:r.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),s.descricao&&e.jsx("p",{className:"text-gray-300 text-sm",children:s.descricao})]},s.id)})})]})]})]})}),M&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-gray-900 rounded-lg max-w-md w-full border border-gray-800",children:[e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 p-6 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:"Adicionar Componente"}),e.jsx("button",{onClick:()=>m(!1),className:"text-white hover:text-gray-200 transition-colors",children:e.jsx("i",{className:"ri-close-line text-2xl"})})]}),e.jsxs("form",{onSubmit:Q,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Componente *"}),e.jsxs("select",{required:!0,value:N,onChange:s=>v(s.target.value),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-purple-500",children:[e.jsx("option",{value:"",children:"Selecione..."}),O.map(s=>e.jsxs("option",{value:s.id,children:[s.nome," - ",s.codigo_interno]},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Quantidade *"}),e.jsx("input",{type:"number",required:!0,min:"1",value:y,onChange:s=>w(parseInt(s.target.value)),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:outline-none focus:border-purple-500"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-6 py-3 bg-gray-800 text-white rounded-lg hover:bg-gray-700 transition-colors whitespace-nowrap",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"flex-1 px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all whitespace-nowrap",children:"Adicionar"})]})]})]})})]})]}):e.jsxs("div",{className:"min-h-screen bg-gray-950 flex",children:[e.jsx(C,{isOpen:l,onToggle:()=>p(!l),darkMode:d}),e.jsxs("div",{className:`flex-1 flex flex-col transition-all duration-300 ${l?"ml-64":"ml-20"}`,children:[e.jsx(S,{darkMode:d,setDarkMode:u}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"ri-error-warning-line text-6xl text-gray-700 mb-4"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Equipamento não encontrado"}),e.jsx("button",{onClick:()=>h("/equipamentos"),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors cursor-pointer",children:"Voltar para Equipamentos"})]})})]})]})}export{Y as default};
//# sourceMappingURL=page-CLztZ2_h.js.map
