import{d as C,u as S,r as o,j as e,L as w,s as b,a as $}from"./index-FRp6wVcD.js";function L({isOpen:s,onToggle:d,darkMode:m}){const h=C();S();const[y,x]=o.useState("dashboard"),[l,n]=o.useState(null),[f,j]=o.useState("AlgodoTech"),[g,c]=o.useState(!1);o.useEffect(()=>{const a=localStorage.getItem("company_logo"),r=localStorage.getItem("company_name");a&&n(a),r&&j(r)},[]);const t=a=>{var p;const r=(p=a.target.files)==null?void 0:p[0];if(r){const u=new FileReader;u.onloadend=()=>{const v=u.result;n(v),localStorage.setItem("company_logo",v)},u.readAsDataURL(r)}},i=a=>{j(a),localStorage.setItem("company_name",a)},N=[{id:"dashboard",label:"Dashboard",icon:"ri-dashboard-line",path:"/dashboard"},{id:"equipamentos",label:"Equipamentos",icon:"ri-tools-line",path:"/equipamentos"},{id:"componentes",label:"Componentes",icon:"ri-settings-3-line",path:"/componentes"},{id:"servicos",label:"Serviços",icon:"ri-briefcase-line",path:"/servicos"},{id:"mapa",label:"Mapa Industrial",icon:"ri-map-2-line",path:"/mapa"},{id:"planejamento",label:"Planejamento",icon:"ri-calendar-line",path:"/planejamento"},{id:"equipes",label:"Equipes",icon:"ri-team-line",path:"/equipes"},{id:"os",label:"Ordens de Serviço",icon:"ri-file-list-3-line",path:"/ordens-servico"},{id:"custos",label:"Custos",icon:"ri-money-dollar-circle-line",path:"/custos"},{id:"tv",label:"Dashboard TV",icon:"ri-tv-line",path:"/dashboard-tv"},{id:"melhorias",label:"Melhorias",icon:"ri-lightbulb-line",path:"/melhorias"},{id:"relatorios",label:"Relatórios",icon:"ri-line-chart-line",path:"/relatorios"},{id:"previsao-falhas",label:"Previsão de Falhas",icon:"ri-brain-line",path:"/previsao-falhas"},{id:"usuarios",label:"Usuários",icon:"ri-user-line",path:"/usuarios"}];return e.jsxs("aside",{className:`fixed left-0 top-0 h-screen ${s?"w-64":"w-20"} bg-gray-900 border-r border-gray-800 transition-all duration-300 flex flex-col z-40`,children:[e.jsxs("div",{className:"h-16 flex items-center justify-between px-4 border-b border-gray-800",children:[s?e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>c(!g),children:[l?e.jsx("img",{src:l,alt:"Logo",className:"w-10 h-10 rounded-lg object-contain flex-shrink-0"}):e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("i",{className:"ri-plant-line text-white text-xl"})}),e.jsx("span",{className:"text-white font-semibold text-base truncate",children:f})]}):e.jsx("div",{className:"cursor-pointer",onClick:()=>c(!g),children:l?e.jsx("img",{src:l,alt:"Logo",className:"w-10 h-10 rounded-lg object-contain"}):e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-plant-line text-white text-xl"})})}),e.jsx("button",{onClick:d,className:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-gray-800 transition-colors cursor-pointer",children:e.jsx("i",{className:`${s?"ri-menu-fold-line":"ri-menu-unfold-line"} text-gray-400 text-xl`})})]}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",onClick:()=>c(!1),children:e.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 w-96 max-w-[90vw]",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Configurações da Empresa"}),e.jsx("button",{onClick:()=>c(!1),className:"w-8 h-8 flex items-center justify-center rounded-lg hover:bg-gray-700 cursor-pointer",children:e.jsx("i",{className:"ri-close-line text-gray-400"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Logo da Empresa"}),e.jsxs("div",{className:"flex items-center gap-4",children:[l?e.jsx("img",{src:l,alt:"Logo",className:"w-20 h-20 rounded-lg object-contain bg-gray-700 p-2"}):e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-plant-line text-white text-3xl"})}),e.jsxs("label",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer whitespace-nowrap",children:[e.jsx("i",{className:"ri-upload-2-line mr-2"}),"Fazer Upload",e.jsx("input",{type:"file",accept:"image/*",onChange:t,className:"hidden"})]}),l&&e.jsx("button",{onClick:()=>{n(null),localStorage.removeItem("company_logo")},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 cursor-pointer whitespace-nowrap",children:e.jsx("i",{className:"ri-delete-bin-line"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Nome da Empresa"}),e.jsx("input",{type:"text",value:f,onChange:a=>i(a.target.value),className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Digite o nome da empresa"})]}),e.jsx("button",{onClick:()=>c(!1),className:"w-full px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 cursor-pointer whitespace-nowrap",children:"Salvar Configurações"})]})]})}),e.jsx("nav",{className:"flex-1 overflow-y-auto py-4",children:N.map(a=>{const r=h.pathname===a.path;return e.jsxs(w,{to:a.path,onClick:()=>x(a.id),className:`flex items-center gap-3 px-4 py-3 mx-2 rounded-lg transition-all cursor-pointer mb-1 ${r?"bg-gradient-to-r from-blue-600 to-purple-600 text-white":"text-gray-400 hover:bg-gray-800 hover:text-white"}`,children:[e.jsx("i",{className:`${a.icon} text-xl w-6 h-6 flex items-center justify-center`}),s&&e.jsx("span",{className:"font-medium whitespace-nowrap",children:a.label})]},a.id)})}),e.jsx("div",{className:"border-t border-gray-800 p-4",children:e.jsxs(w,{to:"/login",className:"flex items-center gap-3 px-4 py-3 rounded-lg text-gray-400 hover:bg-gray-800 hover:text-white transition-all cursor-pointer",children:[e.jsx("i",{className:"ri-logout-box-line text-xl w-6 h-6 flex items-center justify-center"}),s&&e.jsx("span",{className:"font-medium whitespace-nowrap",children:"Sair"})]})})]})}function E({darkMode:s=!0}){const[d,m]=o.useState(!1),[h,y]=o.useState([]),[x,l]=o.useState(0);o.useEffect(()=>{n();const t=b.channel("notifications").on("postgres_changes",{event:"*",schema:"public",table:"notificacoes"},()=>{n()}).subscribe();return()=>{b.removeChannel(t)}},[]);const n=async()=>{try{const{data:t,error:i}=await b.from("notificacoes").select("*").order("created_at",{ascending:!1}).limit(10);if(i)throw i;t&&(y(t),l(t.filter(N=>!N.lida).length))}catch(t){console.error("Erro ao carregar notificações:",t)}},f=async t=>{try{await b.from("notificacoes").update({lida:!0}).eq("id",t),n()}catch(i){console.error("Erro ao marcar como lida:",i)}},j=async()=>{try{await b.from("notificacoes").update({lida:!0}).eq("lida",!1),n()}catch(t){console.error("Erro ao marcar todas como lidas:",t)}},g=t=>{switch(t){case"success":return"ri-checkbox-circle-fill text-green-500";case"error":return"ri-close-circle-fill text-red-500";case"warning":return"ri-error-warning-fill text-yellow-500";default:return"ri-information-fill text-blue-500"}},c=t=>{const i=new Date(t),a=new Date().getTime()-i.getTime(),r=Math.floor(a/6e4),p=Math.floor(a/36e5),u=Math.floor(a/864e5);return r<1?"Agora":r<60?`${r}m atrás`:p<24?`${p}h atrás`:u<7?`${u}d atrás`:i.toLocaleDateString("pt-BR")};return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>m(!d),className:`relative w-10 h-10 rounded-lg flex items-center justify-center cursor-pointer transition-colors ${s?"hover:bg-slate-700":"hover:bg-gray-100"}`,children:[e.jsx("i",{className:`ri-notification-3-line text-xl ${s?"text-gray-300":"text-gray-700"}`}),x>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center font-bold",children:x>9?"9+":x})]}),d&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>m(!1)}),e.jsxs("div",{className:`absolute right-0 mt-2 w-96 rounded-xl shadow-2xl border z-50 ${s?"bg-slate-800 border-slate-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:"p-4 border-b border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:`font-semibold ${s?"text-white":"text-gray-900"}`,children:"Notificações"}),x>0&&e.jsx("button",{onClick:j,className:"text-sm text-purple-400 hover:text-purple-300 cursor-pointer",children:"Marcar todas como lidas"})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:h.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("i",{className:"ri-notification-off-line text-4xl text-gray-400 mb-2"}),e.jsx("p",{className:s?"text-gray-400":"text-gray-600",children:"Nenhuma notificação"})]}):h.map(t=>e.jsx("div",{onClick:()=>!t.lida&&f(t.id),className:`p-4 border-b cursor-pointer transition-colors ${s?"border-slate-700 hover:bg-slate-700/50":"border-gray-200 hover:bg-gray-50"} ${t.lida?"":s?"bg-slate-700/30":"bg-blue-50"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("i",{className:`${g(t.tipo)} text-xl mt-1`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h4",{className:`font-medium ${s?"text-white":"text-gray-900"}`,children:t.titulo}),!t.lida&&e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full flex-shrink-0 mt-2"})]}),e.jsx("p",{className:`text-sm mt-1 ${s?"text-gray-400":"text-gray-600"}`,children:t.mensagem}),e.jsx("p",{className:`text-xs mt-2 ${s?"text-gray-500":"text-gray-400"}`,children:c(t.created_at)})]})]})},t.id))}),h.length>0&&e.jsx("div",{className:"p-3 border-t border-slate-700",children:e.jsx("button",{onClick:()=>{m(!1),window.REACT_APP_NAVIGATE("/notificacoes")},className:"w-full text-center text-sm text-purple-400 hover:text-purple-300 cursor-pointer",children:"Ver todas as notificações"})})]})]})]})}function k({darkMode:s,setDarkMode:d}){const{signOut:m}=$();return e.jsxs("div",{className:`h-16 border-b ${s?"bg-slate-800 border-slate-700":"bg-white border-gray-200"} flex items-center justify-between px-6`,children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("h2",{className:`text-xl font-semibold ${s?"text-white":"text-gray-900"}`,children:"Sistema de Manutenção Industrial"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(E,{darkMode:s}),e.jsx("button",{onClick:()=>d(!s),className:`w-10 h-10 rounded-lg flex items-center justify-center cursor-pointer transition-colors ${s?"hover:bg-slate-700":"hover:bg-gray-100"}`,children:e.jsx("i",{className:`${s?"ri-sun-line":"ri-moon-line"} text-xl ${s?"text-gray-300":"text-gray-700"}`})}),e.jsx("button",{onClick:m,className:"w-10 h-10 rounded-lg bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center cursor-pointer hover:from-purple-700 hover:to-blue-700 transition-all",title:"Sair",children:e.jsx("i",{className:"ri-logout-box-line text-white"})})]})]})}export{L as S,k as T};
//# sourceMappingURL=TopBar-DS7MBlT5.js.map
