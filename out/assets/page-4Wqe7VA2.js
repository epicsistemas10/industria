import{u as Ue,r as l,s as m,j as e}from"./index-FRp6wVcD.js";import{S as Be,T as Ve}from"./TopBar-DS7MBlT5.js";function Qe(){var he,ge,pe,fe,be;const T=Ue(),[z,ye]=l.useState(!0),[s,ve]=l.useState(!0),[f,M]=l.useState([]),[h,v]=l.useState([]),[x,O]=l.useState(null),[D,je]=l.useState("todos"),[H,we]=l.useState("todos"),[Ne,$e]=l.useState([]),[U,B]=l.useState(!0),[V,X]=l.useState(""),[Se,S]=l.useState(!1),[u,Y]=l.useState(!1),[n,F]=l.useState(null),[P,Q]=l.useState(!1),[A,W]=l.useState(!1),[G,J]=l.useState({x:0,y:0}),[Ce,j]=l.useState(!1),[w,K]=l.useState(""),[g,Z]=l.useState(null),[Ee,ee]=l.useState(!1),[ke,N]=l.useState(!1),[b,C]=l.useState("#10b981"),[$,te]=l.useState(14),[E,se]=l.useState("ri-tools-fill"),I=l.useRef(null),[qe,k]=l.useState(!1),[R,ae]=l.useState(""),[re,oe]=l.useState(""),[L,q]=l.useState([]);l.useEffect(()=>{s?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[s]),l.useEffect(()=>{le(),_e(),y();const t=localStorage.getItem("map_image");t&&X(t);const a=setInterval(()=>{le(),y()},3e4);return()=>clearInterval(a)},[]);const _e=async()=>{try{const{data:t,error:a}=await m.from("setores").select("nome").order("nome");if(a)throw a;t&&$e(t.map(r=>r.nome))}catch(t){console.error("Erro ao carregar setores:",t)}},le=async()=>{try{B(!0);const{data:t,error:a}=await m.from("equipamentos").select("*, setores(nome)");if(!a&&t&&t.length>0){const r=t.map(o=>{var i;return{id:o.id,nome:o.nome||"Sem nome",x:0,y:0,status:o.status_revisao>=100?"operacional":o.status_revisao>=50?"manutencao":o.status_revisao>0?"alerta":"parado",setor:((i=o.setores)==null?void 0:i.nome)||"Sem setor",progresso:o.status_revisao||0,criticidade:o.criticidade,fabricante:o.fabricante,modelo:o.modelo}});M(r)}else M([])}catch(t){console.error("Erro ao carregar equipamentos:",t),M([])}finally{B(!1)}},y=async()=>{try{const{data:t,error:a}=await m.from("equipamento_mapa").select("*");if(!a&&t){const r=t.map(o=>({id:o.id,equipamento_id:o.equipamento_id,x:o.x||10,y:o.y||10,width:o.width||8,height:o.height||8,color:o.color||"#10b981",fontSize:o.font_size||14,icon:o.icon||"ri-tools-fill"}));v(r)}}catch(t){console.error("Erro ao carregar hotspots:",t)}},ze=t=>{var r;const a=(r=t.target.files)==null?void 0:r[0];if(a){const o=new FileReader;o.onloadend=()=>{const i=o.result;X(i),localStorage.setItem("map_image",i),S(!1)},o.readAsDataURL(a)}},Me=async()=>{if(w)try{const{data:t}=await m.from("equipamento_mapa").select("id").eq("equipamento_id",w).single();if(t){alert("Este equipamento já possui um hotspot no mapa!");return}const{error:a}=await m.from("equipamento_mapa").insert({equipamento_id:w,x:20,y:20,width:8,height:8});if(a)throw console.error("Erro ao inserir hotspot:",a),a;await y(),j(!1),K(""),alert("Hotspot adicionado com sucesso! Agora você pode arrastá-lo para a posição correta.")}catch(t){console.error("Erro ao adicionar hotspot:",t),alert(`Erro ao adicionar hotspot: ${t.message||"Erro desconhecido"}`)}},ie=(t,a,r=!1)=>{u&&(t.stopPropagation(),F(a),r?W(!0):Q(!0),J({x:t.clientX,y:t.clientY}))},De=t=>{if(!u||!n||!P&&!A||!h.find(d=>d.id===n)||!I.current)return;const r=I.current.getBoundingClientRect(),o=(t.clientX-G.x)/r.width*100,i=(t.clientY-G.y)/r.height*100,c=h.map(d=>{if(d.id===n){if(P)return{...d,x:Math.max(0,Math.min(100-d.width,d.x+o)),y:Math.max(0,Math.min(100-d.height,d.y+i))};if(A)return{...d,width:Math.max(5,Math.min(50,d.width+o)),height:Math.max(5,Math.min(50,d.height+i))}}return d});v(c),J({x:t.clientX,y:t.clientY})},ne=async()=>{if(n&&(P||A)){const t=h.find(a=>a.id===n);if(t)try{const{error:a}=await m.from("equipamento_mapa").update({x:t.x,y:t.y,width:t.width,height:t.height,color:t.color,font_size:t.fontSize,icon:t.icon}).eq("id",t.id);a?(console.error("Erro ao salvar posição:",a),alert("Erro ao salvar posição do hotspot")):console.log("Hotspot salvo com sucesso:",t)}catch(a){console.error("Erro ao salvar posição:",a),alert("Erro ao salvar posição do hotspot")}}Q(!1),W(!1)},He=async t=>{if(confirm("Deseja remover este hotspot?"))try{await m.from("equipamento_mapa").delete().eq("id",t),await y(),F(null)}catch(a){console.error("Erro ao deletar hotspot:",a)}},ce=async t=>{ee(!0);try{const{data:a}=await m.from("equipamentos").select("*, setores(nome)").eq("id",t).single(),{data:r}=await m.from("equipamentos_componentes").select("*, componentes(*)").eq("equipamento_id",t),{data:o}=await m.from("historico_revisoes").select("*").eq("equipamento_id",t).order("data_revisao",{ascending:!1}).limit(5),{data:i}=await m.from("ordens_servico").select("*").eq("equipamento_id",t).order("created_at",{ascending:!1}).limit(5),{data:c}=await m.from("custos").select("*").eq("equipamento_id",t),d=(c==null?void 0:c.reduce((_,p)=>_+(p.valor||0),0))||0;Z({...a,componentes:r||[],historico:o||[],ordens_servico:i||[],custo_total:d})}catch(a){console.error("Erro ao carregar detalhes:",a)}finally{ee(!1)}},Fe=()=>{q(x?[x.id]:[]),ae(""),oe(""),k(!0)},Pe=async()=>{if(!R||L.length===0){alert("Informe o nome do serviço e selecione pelo menos um equipamento.");return}try{const t=L.map(o=>({equipamento_id:o,nome:R,descricao:re||null})),{data:a,error:r}=await m.from("equipamento_servicos").insert(t).select();if(r){console.error("Erro ao criar serviços:",r),alert("Erro ao cadastrar serviço. Veja console para detalhes.");return}alert("Serviço(s) cadastrado(s) com sucesso!"),k(!1),x&&await ce(x.id)}catch(t){console.error("Erro ao cadastrar serviço:",t),alert("Erro ao cadastrar serviço.")}},Ae=async t=>{if(u)return;const a=f.find(r=>r.id===t.equipamento_id);a&&(O(a),await ce(t.equipamento_id))},de=t=>{switch(t){case"operacional":return"#10b981";case"manutencao":return"#f59e0b";case"parado":return"#ef4444";case"alerta":return"#eab308";default:return"#6b7280"}},me=()=>h.filter(t=>{const a=f.find(i=>i.id===t.equipamento_id);if(!a)return!1;const r=D==="todos"||a.status===D,o=H==="todos"||a.setor===H;return r&&o}),Ie={operacional:"Operacional",manutencao:"Manutenção",parado:"Parado",alerta:"Alerta"},Re=me().length,Le=()=>{if(!n)return;const t=h.find(a=>a.id===n);t&&(C(t.color||"#10b981"),te(t.fontSize||14),se(t.icon||"ri-tools-fill"),N(!0))},Te=async()=>{if(!n||!h.find(r=>r.id===n))return;const a=h.map(r=>r.id===n?{...r,color:b,fontSize:$,icon:E}:r);v(a);try{const{error:r}=await m.from("equipamento_mapa").update({color:b,font_size:$,icon:E}).eq("id",n);r?(console.error("Erro ao salvar customização:",r),alert("Erro ao salvar customização")):(console.log("Customização salva com sucesso"),N(!1),await y())}catch(r){console.error("Erro ao salvar customização:",r),alert("Erro ao salvar customização")}},xe=async t=>{if(!n)return;const a=h.find(c=>c.id===n);if(!a)return;const r=Math.max(3,Math.min(30,a.width+t)),o=Math.max(3,Math.min(30,a.height+t)),i=h.map(c=>c.id===n?{...c,width:r,height:o}:c);v(i);try{const{error:c}=await m.from("equipamento_mapa").update({width:r,height:o}).eq("id",n);c?(console.error("Erro ao salvar tamanho:",c),alert("Erro ao salvar tamanho")):console.log("Tamanho salvo com sucesso")}catch(c){console.error("Erro ao salvar tamanho:",c),alert("Erro ao salvar tamanho")}},ue=async t=>{if(!n)return;const a=h.find(i=>i.id===n);if(!a)return;const r=Math.max(8,Math.min(20,(a.fontSize||14)+t)),o=h.map(i=>i.id===n?{...i,fontSize:r}:i);v(o);try{const{error:i}=await m.from("equipamento_mapa").update({font_size:r}).eq("id",n);i?(console.error("Erro ao salvar tamanho da fonte:",i),alert("Erro ao salvar tamanho da fonte")):console.log("Tamanho da fonte salvo com sucesso")}catch(i){console.error("Erro ao salvar tamanho da fonte:",i),alert("Erro ao salvar tamanho da fonte")}},Oe=async()=>{try{const t=h.map(async a=>{const{error:r}=await m.from("equipamento_mapa").update({x:a.x,y:a.y,width:a.width,height:a.height,color:a.color,font_size:a.fontSize,icon:a.icon}).eq("id",a.id);if(r)throw console.error("Erro ao salvar hotspot:",a.id,r),r;return!0});await Promise.all(t),console.log("Todos os hotspots salvos com sucesso"),await y(),Y(!1),F(null),alert("Alterações salvas com sucesso!")}catch(t){console.error("Erro ao salvar hotspots:",t),alert("Erro ao salvar as alterações. Tente novamente.")}};return e.jsxs("div",{className:`min-h-screen ${s?"bg-slate-900":"bg-gray-100"} transition-colors duration-300`,children:[e.jsx(Be,{isOpen:z,onToggle:()=>ye(!z),darkMode:s}),e.jsxs("div",{className:`transition-all duration-300 ${z?"ml-64":"ml-20"}`,children:[e.jsx(Ve,{darkMode:s,setDarkMode:ve}),e.jsxs("main",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-3xl font-bold ${s?"text-white":"text-gray-900"}`,children:"Mapa Industrial Interativo"}),e.jsxs("p",{className:`mt-1 ${s?"text-gray-400":"text-gray-600"}`,children:["Visualização em tempo real dos equipamentos • ",Re," equipamentos exibidos"]})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsxs("button",{onClick:u?Oe:()=>Y(!0),className:`px-4 py-2 rounded-lg transition-all whitespace-nowrap cursor-pointer ${u?"bg-red-600 text-white hover:bg-red-700":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[e.jsx("i",{className:`${u?"ri-save-line":"ri-edit-line"} mr-2`}),u?"Salvar e Sair":"Modo Edição"]}),u&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>j(!0),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all whitespace-nowrap cursor-pointer",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Adicionar Hotspot"]}),n&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:Le,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all whitespace-nowrap cursor-pointer",children:[e.jsx("i",{className:"ri-palette-line mr-2"}),"Personalizar"]}),e.jsxs("div",{className:"flex items-center gap-2 bg-slate-800 rounded-lg px-3 py-2",children:[e.jsx("button",{onClick:()=>xe(-1),className:"w-8 h-8 flex items-center justify-center bg-slate-700 text-white rounded hover:bg-slate-600 cursor-pointer",title:"Diminuir área do hotspot",children:e.jsx("i",{className:"ri-subtract-line"})}),e.jsx("span",{className:"text-white text-sm px-2",children:"Área"}),e.jsx("button",{onClick:()=>xe(1),className:"w-8 h-8 flex items-center justify-center bg-slate-700 text-white rounded hover:bg-slate-600 cursor-pointer",title:"Aumentar área do hotspot",children:e.jsx("i",{className:"ri-add-line"})})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-slate-800 rounded-lg px-3 py-2",children:[e.jsx("button",{onClick:()=>ue(-2),className:"w-8 h-8 flex items-center justify-center bg-slate-700 text-white rounded hover:bg-slate-600 cursor-pointer",title:"Diminuir círculo",children:e.jsx("i",{className:"ri-subtract-line"})}),e.jsx("span",{className:"text-white text-sm px-2",children:"Círculo"}),e.jsx("button",{onClick:()=>ue(2),className:"w-8 h-8 flex items-center justify-center bg-slate-700 text-white rounded hover:bg-slate-600 cursor-pointer",title:"Aumentar círculo",children:e.jsx("i",{className:"ri-add-line"})})]})]})]}),e.jsxs("button",{onClick:()=>S(!0),className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-all whitespace-nowrap cursor-pointer",children:[e.jsx("i",{className:"ri-image-add-line mr-2"}),"Alterar Imagem"]}),e.jsxs("select",{value:D,onChange:t=>je(t.target.value),className:`px-4 py-2 pr-8 rounded-lg border ${s?"bg-slate-800 border-slate-700 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer`,children:[e.jsx("option",{value:"todos",children:"Todos os Status"}),e.jsx("option",{value:"operacional",children:"Operacional"}),e.jsx("option",{value:"manutencao",children:"Manutenção"}),e.jsx("option",{value:"parado",children:"Parado"}),e.jsx("option",{value:"alerta",children:"Alerta"})]}),e.jsxs("select",{value:H,onChange:t=>we(t.target.value),className:`px-4 py-2 pr-8 rounded-lg border ${s?"bg-slate-800 border-slate-700 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer`,children:[e.jsx("option",{value:"todos",children:"Todos os Setores"}),Ne.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),U&&e.jsx("div",{className:`rounded-xl overflow-hidden ${s?"bg-slate-800":"bg-white"} shadow-xl flex items-center justify-center`,style:{height:"calc(100vh - 200px)"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("p",{className:s?"text-gray-400":"text-gray-600",children:"Carregando mapa..."})]})}),!U&&e.jsxs("div",{ref:I,className:`rounded-xl overflow-hidden ${s?"bg-slate-800":"bg-white"} shadow-xl relative ${u?"cursor-crosshair":"cursor-default"}`,style:{height:"calc(100vh - 200px)"},onMouseMove:De,onMouseUp:ne,onMouseLeave:ne,children:[V?e.jsx("img",{src:V,alt:"Mapa Industrial",className:"w-full h-full object-cover pointer-events-none"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-700/30",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"ri-map-pin-line text-5xl text-gray-400 mb-3"}),e.jsx("p",{className:"text-gray-300",children:'Nenhuma imagem do mapa. Faça upload em "Alterar Imagem".'})]})}),me().map(t=>{var d,_;const a=f.find(p=>p.id===t.equipamento_id);if(!a)return null;const r=t.color||de(a.status),o=t.fontSize||14,i=t.icon||"ri-tools-fill",c=o*4;return e.jsxs("div",{className:`absolute group ${u?"cursor-move":"cursor-pointer"} ${n===t.id?"ring-4 ring-blue-500":""}`,style:{left:`${t.x}%`,top:`${t.y}%`,width:`${t.width}%`,height:`${t.height}%`,backgroundColor:u?"rgba(59, 130, 246, 0.3)":"transparent",border:u?"2px dashed #3b82f6":"none"},onMouseDown:p=>ie(p,t.id),onClick:()=>!u&&Ae(t),children:[e.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 rounded-full flex flex-col items-center justify-center shadow-lg transition-transform group-hover:scale-125",style:{backgroundColor:r,width:`${c}px`,height:`${c}px`},children:[e.jsx("i",{className:`${i} text-white mb-1`,style:{fontSize:`${o+4}px`}}),e.jsxs("span",{className:"text-white font-bold",style:{fontSize:`${o-2}px`},children:[a.progresso,"%"]})]}),!u&&e.jsxs("div",{className:`absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 rounded-lg shadow-xl opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-10 ${s?"bg-slate-900 text-white":"bg-white text-gray-900"} border ${s?"border-slate-700":"border-gray-200"}`,children:[e.jsx("div",{className:"font-bold",children:a.nome}),e.jsx("div",{className:"text-sm",children:a.setor}),e.jsxs("div",{className:"text-xs",children:["Revisão: ",a.progresso,"%"]})]}),(((d=a.criticidade)==null?void 0:d.toLowerCase())==="critica"||((_=a.criticidade)==null?void 0:_.toLowerCase())==="crítica")&&e.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"ri-alert-fill text-white text-xs"})}),u&&n===t.id&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute bottom-0 right-0 w-4 h-4 bg-blue-500 cursor-se-resize",onMouseDown:p=>ie(p,t.id,!0)}),e.jsx("button",{onClick:p=>{p.stopPropagation(),He(t.id)},className:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 text-white rounded-full flex items-center justify-center hover:bg-red-600 cursor-pointer",children:e.jsx("i",{className:"ri-close-line text-xs"})})]})]},t.id)})]}),Se&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>S(!1),children:e.jsxs("div",{className:`${s?"bg-slate-800":"bg-white"} rounded-xl p-6 w-full max-w-md`,onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:`text-xl font-bold ${s?"text-white":"text-gray-900"}`,children:"Alterar Imagem do Mapa"}),e.jsx("button",{onClick:()=>S(!1),className:`w-8 h-8 flex items-center justify-center rounded-lg cursor-pointer ${s?"hover:bg-slate-700":"hover:bg-gray-100"}`,children:e.jsx("i",{className:`ri-close-line ${s?"text-gray-400":"text-gray-600"}`})})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center",style:{borderColor:s?"#475569":"#d1d5db"},children:[e.jsx("i",{className:`ri-image-add-line text-5xl mb-4 ${s?"text-gray-400":"text-gray-300"}`}),e.jsx("p",{className:`mb-4 ${s?"text-gray-300":"text-gray-700"}`,children:"Faça upload da imagem do seu mapa industrial"}),e.jsxs("label",{className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 cursor-pointer inline-block whitespace-nowrap",children:[e.jsx("i",{className:"ri-upload-2-line mr-2"}),"Selecionar Imagem",e.jsx("input",{type:"file",accept:"image/*",onChange:ze,className:"hidden"})]})]})})]})}),Ce&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>j(!1),children:e.jsxs("div",{className:`${s?"bg-slate-800":"bg-white"} rounded-xl p-6 w-full max-w-md`,onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:`text-xl font-bold ${s?"text-white":"text-gray-900"}`,children:"Adicionar Hotspot"}),e.jsx("button",{onClick:()=>j(!1),className:`w-8 h-8 flex items-center justify-center rounded-lg cursor-pointer ${s?"hover:bg-slate-700":"hover:bg-gray-100"}`,children:e.jsx("i",{className:`ri-close-line ${s?"text-gray-400":"text-gray-600"}`})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${s?"text-gray-300":"text-gray-700"}`,children:"Selecione o Equipamento"}),e.jsxs("select",{value:w,onChange:t=>K(t.target.value),className:`w-full px-4 py-2 pr-8 rounded-lg border ${s?"bg-slate-700 border-slate-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer`,children:[e.jsx("option",{value:"",children:"Selecione..."}),f.map(t=>e.jsxs("option",{value:t.id,children:[t.nome," - ",t.setor]},t.id))]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>j(!1),className:`flex-1 px-4 py-2 rounded-lg border whitespace-nowrap cursor-pointer ${s?"border-slate-600 text-gray-300 hover:bg-slate-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Cancelar"}),e.jsx("button",{onClick:Me,disabled:!w,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap cursor-pointer",children:"Adicionar"})]})]})]})}),ke&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>N(!1),children:e.jsxs("div",{className:`${s?"bg-slate-800":"bg-white"} rounded-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto`,onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:`text-xl font-bold ${s?"text-white":"text-gray-900"}`,children:"Personalizar Hotspot"}),e.jsx("button",{onClick:()=>N(!1),className:`w-8 h-8 flex items-center justify-center rounded-lg cursor-pointer ${s?"hover:bg-slate-700":"hover:bg-gray-100"}`,children:e.jsx("i",{className:`ri-close-line ${s?"text-gray-400":"text-gray-600"}`})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-3 ${s?"text-gray-300":"text-gray-700"}`,children:"Ícone do Equipamento"}),e.jsx("div",{className:"grid grid-cols-5 gap-3",children:[{icon:"ri-tools-fill",label:"Ferramentas"},{icon:"ri-settings-5-fill",label:"Engrenagem"},{icon:"ri-cpu-fill",label:"CPU"},{icon:"ri-flashlight-fill",label:"Energia"},{icon:"ri-fire-fill",label:"Fogo"},{icon:"ri-water-flash-fill",label:"Água"},{icon:"ri-temp-hot-fill",label:"Temperatura"},{icon:"ri-oil-fill",label:"Óleo"},{icon:"ri-arrow-right-circle-fill",label:"Seta"},{icon:"ri-map-pin-fill",label:"Pin"},{icon:"ri-focus-3-fill",label:"Alvo"},{icon:"ri-radar-fill",label:"Radar"},{icon:"ri-dashboard-fill",label:"Dashboard"},{icon:"ri-speed-fill",label:"Velocidade"},{icon:"ri-plug-fill",label:"Plug"}].map(t=>e.jsx("button",{onClick:()=>se(t.icon),className:`w-12 h-12 rounded-lg flex items-center justify-center cursor-pointer transition-all ${E===t.icon?"bg-blue-600 text-white ring-4 ring-blue-500 scale-110":s?"bg-slate-700 text-gray-300 hover:bg-slate-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,title:t.label,children:e.jsx("i",{className:`${t.icon} text-xl`})},t.icon))})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-3 ${s?"text-gray-300":"text-gray-700"}`,children:"Cor do Indicador"}),e.jsx("div",{className:"grid grid-cols-5 gap-3",children:["#10b981","#3b82f6","#8b5cf6","#f59e0b","#ef4444","#ec4899","#14b8a6","#f97316","#6366f1","#84cc16"].map(t=>e.jsx("button",{onClick:()=>C(t),className:`w-12 h-12 rounded-lg cursor-pointer transition-all ${b===t?"ring-4 ring-blue-500 scale-110":"hover:scale-105"}`,style:{backgroundColor:t}},t))}),e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx("input",{type:"color",value:b,onChange:t=>C(t.target.value),className:"w-12 h-12 rounded-lg cursor-pointer"}),e.jsx("input",{type:"text",value:b,onChange:t=>C(t.target.value),className:`flex-1 px-3 py-2 rounded-lg border ${s?"bg-slate-700 border-slate-600 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-blue-500`})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-3 ${s?"text-gray-300":"text-gray-700"}`,children:["Tamanho da Fonte: ",$,"px"]}),e.jsx("input",{type:"range",min:"10",max:"24",value:$,onChange:t=>te(Number(t.target.value)),className:"w-full cursor-pointer"}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{className:s?"text-gray-400":"text-gray-600",children:"10px"}),e.jsx("span",{className:s?"text-gray-400":"text-gray-600",children:"24px"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-3 ${s?"text-gray-300":"text-gray-700"}`,children:"Pré-visualização"}),e.jsx("div",{className:"flex items-center justify-center p-6 bg-slate-700 rounded-lg",children:e.jsxs("div",{className:"rounded-full flex flex-col items-center justify-center shadow-lg",style:{backgroundColor:b,width:"64px",height:"64px"},children:[e.jsx("i",{className:`${E} text-white mb-1`,style:{fontSize:`${$+4}px`}}),e.jsx("span",{className:"text-white font-bold text-xs",children:"85%"})]})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>N(!1),className:`flex-1 px-4 py-2 rounded-lg border whitespace-nowrap cursor-pointer ${s?"border-slate-600 text-gray-300 hover:bg-slate-700":"border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:"Cancelar"}),e.jsx("button",{onClick:Te,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 whitespace-nowrap cursor-pointer",children:"Aplicar"})]})]})]})}),x&&!u&&e.jsxs("div",{className:`fixed right-6 top-24 w-96 rounded-xl shadow-2xl ${s?"bg-slate-800 border-slate-700":"bg-white border-gray-200"} border p-6 z-50 max-h-[calc(100vh-120px)] overflow-y-auto`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:`text-xl font-bold ${s?"text-white":"text-gray-900"}`,children:"Detalhes do Equipamento"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:Fe,className:"px-3 py-1 rounded-md bg-emerald-600 text-white hover:bg-emerald-700 text-sm",children:"Cadastrar Serviço Padrão"}),e.jsx("button",{onClick:()=>{O(null),Z(null)},className:`w-8 h-8 rounded-lg flex items-center justify-center cursor-pointer ${s?"hover:bg-slate-700":"hover:bg-gray-100"}`,children:e.jsx("i",{className:`ri-close-line ${s?"text-gray-400":"text-gray-600"}`})})]})]}),Ee?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),e.jsx("p",{className:s?"text-gray-400":"text-gray-600",children:"Carregando..."})]}):g?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Nome"}),e.jsx("p",{className:`font-medium ${s?"text-white":"text-gray-900"}`,children:x.nome})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Setor"}),e.jsx("p",{className:`font-medium ${s?"text-white":"text-gray-900"}`,children:x.setor})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Status"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:de(x.status)}}),e.jsx("span",{className:`font-medium capitalize ${s?"text-white":"text-gray-900"}`,children:Ie[x.status]||x.status})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Progresso da Revisão"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"flex items-center justify-between mb-1",children:e.jsxs("span",{className:`text-sm font-medium ${s?"text-white":"text-gray-900"}`,children:[x.progresso,"%"]})}),e.jsx("div",{className:`w-full h-2 rounded-full ${s?"bg-slate-700":"bg-gray-200"}`,children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-blue-600 to-purple-600",style:{width:`${x.progresso}%`}})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Custo Acumulado"}),e.jsxs("p",{className:`font-bold text-lg ${s?"text-green-400":"text-green-600"}`,children:["R$ ",((he=g.custo_total)==null?void 0:he.toLocaleString("pt-BR",{minimumFractionDigits:2}))||"0,00"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`text-sm font-medium ${s?"text-gray-300":"text-gray-700"}`,children:["Componentes (",((ge=g.componentes)==null?void 0:ge.length)||0,")"]}),e.jsxs("div",{className:"mt-2 space-y-2 max-h-40 overflow-y-auto",children:[(pe=g.componentes)==null?void 0:pe.map(t=>{var a;return e.jsxs("div",{className:`p-2 rounded-lg ${s?"bg-slate-700":"bg-gray-100"}`,children:[e.jsx("p",{className:`text-sm font-medium ${s?"text-white":"text-gray-900"}`,children:((a=t.componentes)==null?void 0:a.nome)||"Sem nome"}),e.jsxs("p",{className:`text-xs ${s?"text-gray-400":"text-gray-600"}`,children:["Qtd: ",t.quantidade||0]})]},t.id)}),(!g.componentes||g.componentes.length===0)&&e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Nenhum componente vinculado"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-sm font-medium ${s?"text-gray-300":"text-gray-700"}`,children:"Ordens de Serviço Recentes"}),e.jsxs("div",{className:"mt-2 space-y-2 max-h-40 overflow-y-auto",children:[(fe=g.ordens_servico)==null?void 0:fe.map(t=>e.jsxs("div",{className:`p-2 rounded-lg ${s?"bg-slate-700":"bg-gray-100"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:`text-sm font-medium ${s?"text-white":"text-gray-900"}`,children:["OS #",t.numero_os||t.id.slice(0,8)]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${t.status==="concluida"?"bg-green-500/20 text-green-400":"bg-yellow-500/20 text-yellow-400"}`,children:t.status})]}),e.jsx("p",{className:`text-xs ${s?"text-gray-400":"text-gray-600"}`,children:new Date(t.created_at).toLocaleDateString("pt-BR")})]},t.id)),(!g.ordens_servico||g.ordens_servico.length===0)&&e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Nenhuma OS registrada"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-sm font-medium ${s?"text-gray-300":"text-gray-700"}`,children:"Histórico de Manutenção"}),e.jsxs("div",{className:"mt-2 space-y-2 max-h-40 overflow-y-auto",children:[(be=g.historico)==null?void 0:be.map(t=>e.jsxs("div",{className:`p-2 rounded-lg ${s?"bg-slate-700":"bg-gray-100"}`,children:[e.jsx("p",{className:`text-sm font-medium ${s?"text-white":"text-gray-900"}`,children:t.tipo_revisao||"Manutenção"}),e.jsx("p",{className:`text-xs ${s?"text-gray-400":"text-gray-600"}`,children:new Date(t.data_revisao).toLocaleDateString("pt-BR")})]},t.id)),(!g.historico||g.historico.length===0)&&e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Nenhum histórico registrado"})]})]}),e.jsx("button",{onClick:()=>T(`/equipamento-detalhes?id=${x.id}`),className:"w-full px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all whitespace-nowrap cursor-pointer",children:"Ver Detalhes Completos"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Nome"}),e.jsx("p",{className:`font-medium ${s?"text-white":"text-gray-900"}`,children:x.nome})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Setor"}),e.jsx("p",{className:`font-medium ${s?"text-white":"text-gray-900"}`,children:x.setor})]}),e.jsx("button",{onClick:()=>T(`/equipamento-detalhes?id=${x.id}`),className:"w-full px-4 py-2 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all whitespace-nowrap cursor-pointer",children:"Ver Detalhes Completos"})]})]}),qe&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:`${s?"bg-slate-800":"bg-white"} rounded-xl w-full max-w-2xl p-6`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:`text-lg font-semibold ${s?"text-white":"text-gray-900"}`,children:"Cadastrar Serviço Padrão"}),e.jsx("button",{onClick:()=>k(!1),className:`w-8 h-8 rounded flex items-center justify-center ${s?"hover:bg-slate-700":"hover:bg-gray-100"}`,children:e.jsx("i",{className:`ri-close-line ${s?"text-gray-300":"text-gray-600"}`})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${s?"text-gray-300":"text-gray-700"}`,children:"Nome do Serviço"}),e.jsx("input",{type:"text",value:R,onChange:t=>ae(t.target.value),className:`w-full px-4 py-2 rounded-lg border ${s?"bg-slate-700 border-slate-600 text-white":"bg-white border-gray-300 text-gray-900"}`,placeholder:"Ex: Troca de correia"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${s?"text-gray-300":"text-gray-700"}`,children:"Descrição (opcional)"}),e.jsx("textarea",{value:re,onChange:t=>oe(t.target.value),className:`w-full px-4 py-2 rounded-lg border ${s?"bg-slate-700 border-slate-600 text-white":"bg-white border-gray-300 text-gray-900"}`,rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${s?"text-gray-300":"text-gray-700"}`,children:"Selecionar Equipamentos"}),e.jsxs("div",{className:"mt-2 max-h-48 overflow-y-auto space-y-2 p-2 rounded border",children:[f.map(t=>e.jsxs("label",{className:`flex items-center gap-2 cursor-pointer p-1 rounded ${s?"hover:bg-slate-700":"hover:bg-gray-50"}`,children:[e.jsx("input",{type:"checkbox",checked:L.includes(t.id),onChange:a=>{a.target.checked?q(r=>[...r,t.id]):q(r=>r.filter(o=>o!==t.id))}}),e.jsx("span",{className:`${s?"text-gray-200":"text-gray-900"}`,children:t.nome})]},t.id)),f.length===0&&e.jsx("p",{className:`text-sm ${s?"text-gray-400":"text-gray-600"}`,children:"Nenhum equipamento disponível"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>k(!1),className:`flex-1 px-4 py-2 rounded-lg ${s?"bg-slate-700 text-white hover:bg-slate-600":"bg-gray-200 text-gray-900 hover:bg-gray-300"}`,children:"Cancelar"}),e.jsx("button",{onClick:Pe,className:"flex-1 px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700",children:"Cadastrar"})]})]})]})})]})]})]})}export{Qe as default};
//# sourceMappingURL=page-4Wqe7VA2.js.map
